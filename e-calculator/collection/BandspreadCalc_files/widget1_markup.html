<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><title></title>


<script language="JavaScript">
var d = null;
function PadCalc(ctrm,cvlo,cvhi,cstray,rc) {
    chp = cvhi+ctrm;
    clp = cvlo+ctrm;
    beta=(rc-1)*cstray;
    a=rc* clp- chp +beta;
    b= (rc-1)*clp*chp+beta*(clp + chp);
    c=beta*clp* chp;
    cser=(-b-Math.sqrt(b*b-4*a*c))/(a+a);
    return(cser);
}
function TrmCalc(cser,cvlo,cvhi,cstray,rc) {
    if (cser<0.00001) {
      ctrm=(cvhi+cstray-rc*(cvlo+cstray))/(rc-1);
      }
    else {
      cser2=cser*cser;
      k0=(1-rc)*cstray;
      k1=k0*cser2;
      k2=k0*cser+cser2;
      k3=k0*cser-rc*cser2;
      k4=k0+(1-rc)*cser;
      a=k4;
      b=k2+k3+k4*(cvlo+cvhi);
      c=k1+k2*cvhi+k3*cvlo+k4*cvlo*cvhi;
      ctrm=(-b-Math.sqrt(b*b-4*a*c))/(a+a);
      }
    return(ctrm);
}

function setCellTxt(id,tx,clr){
  cell=document.getElementById(id);
  cell.innerHTML=tx;
  cell.style.color=clr;
}

function CalcAll() {
  setCellTxt("ex_cpar","***","#FF0000");
  setCellTxt("ex_cser","***","#FF0000");
  setCellTxt("ex_L","***","#FF0000");
  flo = parseFloat(d.ef_flo.value);
  fhi = parseFloat(d.ef_fhi.value);
  cvlo = parseFloat(d.ef_cvlo.value);
  cvhi = parseFloat(d.ef_cvhi.value);
  cstray = parseFloat("0".concat(d.ef_cstray.value));
  KVal = parseFloat(d.ef_KVal.value);
  spi = 500000.0/Math.PI;
  rf=fhi/flo;
  rc=rf*rf;
  switch(d.mknown.selectedIndex){
   case 0:
    // For Given inductor
    L = KVal;
    w=(spi/flo)
    chppp = w*w/L;
    w=(spi/fhi)
    clppp = w*w/L;
    alpha = cstray-chppp;
    beta = cstray-clppp;
    k1 = cvhi-chppp-cvlo+clppp;
    k2 = alpha - beta;
    k3 = alpha*cvhi - beta*cvlo;
    k4 = alpha*cvhi;
    k5 = cvhi + alpha;
    a = -k2/k1;
    b = alpha-(k3+k2*k5)/k1;
    c = k4-(k3*k5)/k1;
    ctrm = (-b+Math.sqrt(b*b-4*a*c))/(a+a);
    cser = -(k2*ctrm+k3)/k1;
    if (cser>100*cvhi) cser=0;
    // End of given L calc
   break;
   case 1:
    // For Given Padder
    cser=KVal;
    if (cser<.00001) {
      cpinv=0;
    }
    else {
      cpinv=1/cser;
    }
    ctrm=TrmCalc(cser,cvlo,cvhi,cstray,rc);
    chp=cvhi+ctrm;
    chppp=1/(1/chp+cpinv)+cstray;
    w=spi/flo;
    L=w*w/chppp;
   break;
   case 2:
    // For Given Trimmer
    ctrm=KVal;
    cser=PadCalc(ctrm,cvlo,cvhi,cstray,rc);
    chppp=chp*cser/(chp+cser)+cstray;
    if (cser>100*cvhi) cser=0;
    w=spi/flo;
    L=w*w/chppp
   break;
  }
  badVal=false;
  if (isNaN(ctrm) || ctrm<0) badVal=true;
  if (isNaN(cser) || cser <0) badVal=true;
  if (isNaN(L) || L<0) badVal=true;
  if (!badVal) {
    setCellTxt("ex_cpar",ctrm.toFixed(2),"#000080");
    setCellTxt("ex_cser",cser.toFixed(2),"#000080");
    setCellTxt("ex_L",L.toFixed(2),"#000080");
  }
}
function CalcRange() {
 flo = parseFloat(d.ef_flo.value);
 fhi = parseFloat(d.ef_fhi.value);
 cvlo = parseFloat(d.ef_cvlo.value);
 cvhi = parseFloat(d.ef_cvhi.value);
 cstray = parseFloat("0".concat(d.ef_cstray.value));
 if (flo>0 && fhi>0 && cvlo>0 && cvhi>0) {
  spi = 500000.0/Math.PI;
  rf=fhi/flo;
  rc=rf*rf;
  csmin=PadCalc(0,cvlo,cvhi,cstray,rc);
  ctmax=TrmCalc(0,cvlo,cvhi,cstray,rc);
  w=spi/flo
  chppp=cvhi*csmin/(cvhi+csmin)+cstray;
  Lmax=w*w/chppp;
  chppp=cvhi+ctrm+cstray;
  Lmin=w*w/chppp;
  //Reset exact calc outputs after input parameter change
/*
  setCellTxt("ex_cpar","","#000080");
  setCellTxt("ex_cser","","#000080");
  setCellTxt("ex_L","","#000080");
*/
  if (Lmin<0 || Lmax<0 || ctmax<0 || csmin<0) {
    setCellTxt("rTrm","***","#FF0000");
    setCellTxt("rPad","***","#FF0000");
    setCellTxt("rInd","***","#FF0000");
  }
  else {
    setCellTxt("rTrm","0 ... ".concat(ctmax.toFixed(2)),"#000080");
    setCellTxt("rPad",">= ".concat(csmin.toFixed(2)," (if present)"),"#000080");
    setCellTxt("rInd","".concat(Lmin.toFixed(2)," ... ",Lmax.toFixed(2)),"#000080");
  }
 }
}
function kvChange() {
 descriptions = Array ("Enter Inductance Value (&micro;H):","Enter Series Capacitance Value (pF):","Enter Parallel Capacitance Value: (pF)");
 setCellTxt("KVdescription",descriptions[d.mknown.selectedIndex],"#000080");
 setCellTxt("ex_cpar","","#000080");
 setCellTxt("ex_cser","","#000080");
 setCellTxt("ex_L","","#000080");
}
</script>


</head>


<body onload="d = document.forms[0];">


<form target="_top" onsubmit="return false">
  <table style="width: 692px; height: 400px; font-size: 14pt;" align="center" border="0">
   <caption style="font-size: 20pt"><b>Bandspread Calculator</b></caption>
    <tbody>
      <tr>
        <td colspan="3&quot;" align="center">&nbsp;</td>
      </tr>
      <tr>
        <td colspan="3&quot;" align="center"><b>Input Parameters:</b></td>
      </tr>


      <tr>
        <td align="right">Lowest Frequency (kHz):</td>
        <td><input name="ef_flo" onchange="CalcRange()" size="18"> </td>
      </tr>
      <tr>
        <td align="right">Highest Frequency (kHz):</td>
        <td><input name="ef_fhi" onchange="CalcRange()" size="18"> </td>
      </tr>
      <tr>
        <td align="right">Tuning Capacitor <i>C<sub>V</sub></i> Minimum Capacitance (pF):</td>
        <td><input name="ef_cvlo" onchange="CalcRange()" size="18"> </td>
      </tr>
      <tr>
        <td align="right">Tuning Capacitor <i>C<sub>V</sub></i> Maximum Capacitance (pF):</td>
        <td><input name="ef_cvhi" onchange="CalcRange()" size="18"> </td>
      </tr>
      <tr>
        <td align="right">Stray Capacitance <i>C<sub>S</sub></i> (pF):</td>
        <td><input name="ef_cstray" onchange="CalcRange()" size="18"> </td>
      </tr>

      <tr>
        <td colspan="2&quot;" align="center"><hr></td>
      </tr>
      <tr>
        <td colspan="2&quot;" align="center"><b>Allowable Component Ranges:</b></td>
      </tr>

      <tr>
        <td align="right">Trimmer Capacitor <i>C<sub>T</sub></i> (pF):&nbsp;&nbsp;</td>
        <td id="rTrm" align="left"><font color="#FF0000">***</font></td>
      </tr>
      <tr>
        <td align="right">Padder Capacitor <i>C<sub>P</sub></i> (pF):&nbsp;&nbsp;</td>
        <td id="rPad" align="left"><font color="#FF0000">***</font></td>
      </tr>
      <tr>
        <td align="right">Inductor (µH):&nbsp;&nbsp;</td>
        <td id="rInd" align="left"><font color="#FF0000">***</font></td>
      </tr>


      <tr>
        <td colspan="2&quot;" align="center"><hr></td>
      </tr>

      <tr>
        <td colspan="2&quot;" align="center"><b>Exact Value Calculation:</b></td>
      </tr>

      <tr>
        <td align="right">Choose the Known Component:</td>
        <td>
          <select name="mknown" onchange="kvChange()" size="1">
           <option selected="selected">Inductor</option>
           <option>Padder Capacitor (Series)</option>
           <option>Trimmer Capacitor (Parallel)</option>
          </select>
        </td>
      </tr>
      <tr>
        <td id="KVdescription" align="right">Enter the Known Component Value:</td>
        <td><input name="ef_KVal" size="18"></td>
      </tr>
      <tr>
      <td align="right">Click to Calculate the Unknown Components:</td>
      <td><input value="Calculate" onclick="CalcAll()" type="button"> </td>
      </tr>
      <tr>
        <td align="right">Trimmer Capacitor <i>C<sub>T</sub></i> (pF):&nbsp;&nbsp;</td>
       <td id="ex_cpar"> </td>
      </tr>
      <tr>
        <td align="right">Padder Capacitor <i>C<sub>P</sub></i> (pF):&nbsp;&nbsp;</td>
        <td id="ex_cser"> </td>
      </tr>
      <tr>
        <td align="right">Inductor (µH):&nbsp;&nbsp;</td>
        <td id="ex_L"> </td>
      </tr>
    </tbody>
  </table>
</form>
</body></html>