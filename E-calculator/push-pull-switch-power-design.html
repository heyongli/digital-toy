<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
  
  <script><head>
  <script><head>
  <script></script>
  
  <meta http-equiv="Content-Language" content="en-us">

  
  <meta http-equiv="Content-Type" content="text/html; charset=Big5">

  
  <meta name="GENERATOR" content="Microsoft FrontPage 6.0">

  
  <meta name="ProgId" content="FrontPage.Editor.Document">
  <title>Push-Pull Switch power design</title>

  
</head><body oncontextmenu="return false">
<br>


<table style="border-collapse: collapse;" id="AutoNumber1" bgcolor="#ffffff" border="0" bordercolor="#111111" cellpadding="6" cellspacing="0" width="800">

  <tbody>
    <tr>
      <td>
      <p style="margin-top: 0pt; margin-bottom: 0pt;" align="center"><br>
      </p>
      <form id="switch" name="switch">
        <div align="center">
        <center>
        <table style="border-collapse: collapse; width: 683px; height: 918px;" id="AutoNumber2" border="0" bordercolor="#111111" cellpadding="3" cellspacing="3">
          <tbody>
            <tr>
              <td colspan="2" bgcolor="#ffff00" width="100%">
              <p style="margin-top: 0pt; margin-bottom: 0pt; background-color: rgb(178, 223, 223);"><b><img style="width: 1024px; height: 599px;" alt="lm5030 push pull switch power circuit" src="e-calculator-res/lm5030-push-pull-switch-power.jpg"><br>
弧G<br>
1.崩DC-DC┹シiHRだQノ合<br>
2.MOSFET &#30005;&#21387;&#20026;&#36755;J&#30005;&#21387;&#20004;<br>
              </b></p>
              </td>
            </tr>
            <tr>
              <td colspan="2" bgcolor="#ffffcc" width="100%">
              <ol>
              </ol>
              </td>
            </tr>
            <tr>
              <td colspan="2" bgcolor="#ffff00" width="100%"> <span style="font-weight: bold;">&#36755;J&#36755;X&#21442;&#25968;:</span><br>
              </td>
            </tr>
            <tr>
              <td style="background-color: rgb(238, 196, 89);" bgcolor="#ffffcc" width="16%">
              <div style="text-align: right;"> </div>
              <p style="margin-top: 0pt; margin-bottom: 0pt; text-align: right;">块J&#30005;&#21387;<br>
              </p>
              </td>
              <td style="background-color: rgb(253, 253, 202);" bgcolor="#ffffcc" width="84%">
              <p style="margin-top: 0pt; margin-bottom: 0pt;">程C:<input value="35" name="Vi_min" size="4">ヱS(DC/V)&nbsp;&nbsp;&nbsp; 程蔼:<input value="75" name="Vi_max" size="4">ヱS(DC/V)&nbsp;&nbsp;&nbsp; タ`: <input value="48" name="Vi_nom" size="4">ヱS(DC/V)&nbsp;&nbsp;&nbsp; </p>
              </td>
            </tr>
            <tr>
              <td style="background-color: rgb(238, 196, 89);" bgcolor="#ffffcc" width="16%">
              <p style="margin-top: 0pt; margin-bottom: 0pt;" align="right">&#36755;X1</p>
              </td>
              <td style="background-color: rgb(253, 253, 202);" bgcolor="#ffffcc" width="84%">
              <p style="margin-top: 0pt; margin-bottom: 0pt;"><span lang="zh-tw">&#30005;&#21387;:</span><input value="12" name="Vo1" size="3"> V<span lang="zh-tw">&nbsp;&nbsp;&nbsp; 程C&#30005;y: </span> <input value="0.5" name="Io1_min" size="3"> A&nbsp; &nbsp; 程j&#30005;y:<input value="5" name="Io1_max" size="3"> A &nbsp; i&#32441;:<input value="100" name="Vrp1" size="3"> mV<br>
              </p>
              </td>
            </tr>
            <tr>
              <td style="background-color: rgb(238, 196, 89);" bgcolor="#ffffcc" width="16%">
              <p style="margin-top: 0pt; margin-bottom: 0pt;" align="right">&#36755;X2<br>
              </p>
              </td>
              <td style="background-color: rgb(253, 253, 202);" bgcolor="#ffffcc" width="84%">
              <p style="margin-top: 0pt; margin-bottom: 0pt;"> <span lang="zh-tw">&#30005;</span><span lang="zh-tw">&#21387;:</span><input value="3.7" name="Vo2" size="3"> V<span lang="zh-tw">&nbsp;&nbsp;&nbsp; 程C&#30005;y: </span>
              <input value="0.1" name="Io2_min" size="3"> A&nbsp;
&nbsp; 程j&#30005;y:<input value="0.5" name="Io2_max" size="3"> A &nbsp; i&#32441;:<input value="120" name="Vrp2" size="3"> mV</p>
              </td>
            </tr>
            <tr>
              <td style="background-color: rgb(238, 196, 89);" bgcolor="#ffffcc" width="16%">
              <p align="right"><span lang="zh-tw">俱y/&#24320;&#20851;恨&#21387;</span></p>
              </td>
              <td style="background-color: rgb(253, 253, 202);" bgcolor="#ffffcc" width="84%">俱yG体恨&#21387;: <span lang="zh-tw"></span><input value="0.9" name="Vd_fw" size="3">V<span lang="zh-tw"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOSFET&#23548;q&#30005;:</span><input value="0.1" name="Rds_on" size="3"><span lang="zh-tw">ohm</span><span lang="zh-tw"> </span></td>
            </tr>
            <tr>
              <td style="vertical-align: top; text-align: right; background-color: rgb(238, 196, 89);">&#24320;
&#20851;&#30005;方&#21442;&#25968;<br>
              </td>
              <td style="vertical-align: top;">崩&#39057;v:<input value="250" name="fsw" size="3">
kHz&nbsp;&nbsp;&nbsp; &#24320;&#20851;&#30005;方牟vb :<input value="0.95" name="n" size="3">(&#35745;)&nbsp;&nbsp; 程je扭: <input value="0.365" name="D_max" size="3">D<small>max (躬浃nD程p&#36755;J&#30005;&#21387;U&lt;&lt;40%)</small><br>
</td>
            </tr>
            <tr>
              <td colspan="2" bgcolor="#ffff00" width="100%">
              <p style="margin-top: 0pt; margin-bottom: 0pt; background-color: rgb(189, 75, 75);">\vだR:<input value="&#35745;衡" name="Initcalc" onclick="Pcalc()" type="button">&nbsp;&nbsp; <input value="`" name="Initcalc" onclick="this.form.reset()" type="button"></p>
              </td>
            </tr>
            <tr>
              <td colspan="2" bgcolor="#ffffcc" width="100%">
              <div style="text-align: left;"> </div>
              
              <p style="margin-top: 0pt; margin-bottom: 0pt; text-align: left; background-color: rgb(243, 243, 243);"><span lang="zh-tw"></span><span lang="zh-tw"></span><span lang="zh-tw"></span><span lang="zh-tw"></span><span lang="zh-tw"></span><small><font color="#800000" size="5"><small><b> 程j\vPomaxG</b></small></font><input name="Po_max" size="5" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"><font color="#800000" size="5"><small><b>
W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 程p\vPomin:</b></small></font><input name="Po_min" size="5" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small><b><font color="#800000" size="5"><small> W</small></font></b><font color="#800000" size="5"><small style="color: black;">&nbsp;&nbsp;</small></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              <br>
<span lang="zh-tw"></span></p>

              </td>
            </tr>
            <tr>
              <td colspan="2" rowspan="1" style="vertical-align: top; background-color: rgb(229, 229, 229);"><font color="#800000" size="5"><small style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#24320;&#20851;P戳T:&nbsp; </small></font><small><input name="T" size="4" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small><font color="#800000" size="5"><small style="color: black;"> uSec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; </small></font><font color="#800000" size="5"><small style="color: black;">D&#32469;&#32452;C&#20010;wing&#24320;&#20851;P戳: </small></font><small><input name="Tch" size="4" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small><font color="#800000" size="5"><small style="color: black;"> uSec<br>&nbsp;CwingTon<small><small>max<big><big>:&nbsp; &nbsp;  </big></big></small></small></small></font><small><input name="Ton_max" size="4" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small>uSec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              <span style="font-weight: bold;">程j&#36755;J&#30005;&#21387;撼踏pe扭:</span> <small><input name="Dmin" size="4" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small> Dmin<br>
              <span style="font-weight: bold;">タ`&#36755;J&#30005;&#21387;e扭</span>:&nbsp;&nbsp;  <small><input name="Dnom" size="4" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small>Dnom<br>
              </td>
            </tr>
            <tr>
              <td colspan="2" rowspan="1" style="vertical-align: top;"><font color="#800000" size="5"><small style="color: black;">MOSFET程j&#23548;q&#21387;:&nbsp; </small></font><small><input name="Vds_on" size="5" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small> V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOSFET┯程j@&#21387;:<small><input name="Vsw_max" size="5" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small> (程jDC&#30005;&#21387;+30%&#30005;Pyp)</td>
            </tr>
            <tr>
              <td colspan="2" rowspan="1" style="vertical-align: top; background-color: rgb(244, 244, 244);"><font color="#800000" size="5"><small style="color: black;"><span style="font-weight: bold;">`ゑ(s/p):</span>&nbsp;</small></font><font color="#800000" size="5"><small style="color: black;">  </small></font><small><input name="Nsp1" size="4" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small><font color="#800000" size="5"><small style="color: black;"> </small></font><font color="#800000" size="5"><small style="color: black;"></small></font></td>
            </tr>
            <tr>
              <td colspan="2" rowspan="1" style="vertical-align: top;"><img style="width: 307px; height: 266px;" alt="secondary-wing current" src="e-calculator-res/lm5030-switch-secondary-wing-current.jpg" align="left"><br>
Primary&nbsp; wing&nbsp;&nbsp; DC&nbsp; current: <small><input name="Ip_dc" size="5" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small>A&nbsp; (Ip_dc)<br>
              <span style="font-weight: bold;">Primary flat top&nbsp; current:</span> <small><input name="Ip_ft" size="5" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small>A&nbsp;&nbsp; (Ip_ft)<br>
              <span style="font-weight: bold;">Primary rms&nbsp; current &nbsp;&nbsp;&nbsp; :</span> <small><input name="Ip_rms" size="5" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small>A&nbsp; (Ip_rms)<br>
Primary&nbsp;&nbsp; AC&nbsp;&nbsp; current&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; : <small><input name="Ip_ac" size="5" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small>A&nbsp; (Ip_ac)<br>
              <br>
              <br>
              <br>
              <span style="font-weight: bold;">Secondary1 rms current:</span> <small><input name="Is1_rms" size="5" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small>A&nbsp; (Is1_rms)<br>
              <span style="font-weight: bold;">Secondary2 rms current: </span><small><input name="Is2_rms" size="5" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small>A&nbsp; (Is2_rms)<br>
Secondary1&nbsp;&nbsp;&nbsp; ac current &nbsp; : <small><input name="Is1_ac" size="5" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small>A&nbsp; (Is1_ac)<br>
Secondary2&nbsp;&nbsp;&nbsp; ac current &nbsp; : <small><input name="Is2_ac" size="5" style="background-color: rgb(204, 255, 153); color: rgb(255, 0, 0); text-align: center;" readonly="readonly"></small>A&nbsp; (Is2_ac)<br>
              </td>
            </tr>
<tr>
              <td style="vertical-align: top;"><br>
              </td>
              <td style="vertical-align: top;"><input name="CLOSERST" value="ON" checked="checked" type="checkbox"><span lang="zh-tw">郯士铷郦瘠
カ扳 &nbsp;</span><span lang="zh-tw">
              <select size="1" name="RRES" style="font-family: Arial; font-size: 12pt;">
              <option selected="selected" value="0">5%</option>
              <option value="1">1%</option>
              </select>
              </span></td>
            </tr>
          </tbody>
        </table>
        </center>
        </div>
        <p style="margin-top: 0pt; margin-bottom: 0pt;" align="center">@</p>
        <p style="margin-top: 0pt; margin-bottom: 0pt;" align="center">
        <script language="JavaScript">
//----stage0 ----------
var Vi_min,Vi_max,Vi_nom; //V
var Vo1,Vrp1,Io1_min,Io1_max; //V,mV,A,A
var Vo2,Vrp2,Io2_min,Io2_max;
var n; //switch effecncy
var fsw; //KHz
var Vd_fw, Rds_on;
//output stage 0 
var Po_min=0,Po_max=0;
var T=0,Tch=0;
var Vds_on=0;

//---- stage 1-----
var D_max = 0;
//output_stage 1
var Ton_max=0;
var Nsp1=0; //`ゑ
var Dmin = 0, Dnom = 0;

//----stage 2-----
var Vsw_max = 0;

//--stage 3----
var Ip_dc, Ip_ft,Ip_rms,Ip_ac;
var Is1_rms, Is2_rms, Is1_ac, Is2_ac;



//-------
var formid = "switch";
function getVar(name)
{
    var x=document.getElementById(formid);
    for (var i=0;i<x.length;i++)
    {
	if(x.elements[i].name==name)
		return parseFloat(x.elements[i].value);    
    }
}

function setVar(name,v)
{
    var x=document.getElementById(formid);
    for (var i=0;i<x.length;i++)
    {
	if(x.elements[i].name==name)
		x.elements[i].value = v;    
    }
}

function get_switch_para()
{
  Vi_min = getVar("Vi_min");
   Vi_max = getVar("Vi_max");
   Vi_nom = getVar("Vi_nom");

   Vo1 = getVar("Vo1");
   Vrp1= getVar("Vrp1");
   Io1_min= getVar("Io1_min");
   Io1_max = getVar("Io1_max");

   Vo2 = getVar("Vo2");
   Vrp2= getVar("Vrp2");
   Io2_min= getVar("Io2_min");
   Io2_max = getVar("Io2_max");

   n = getVar("n");
   fsw = getVar("fsw");

   Vd_fw =  getVar("Vd_fw");
   Rds_on =  getVar("Rds_on");

}
function round3(v)
{
   return Math.round(v*1000)/1000;
}
function round2(v)
{
   return Math.round(v*100)/100;
}

function Pcalc()
{
  
   get_switch_para();
   //----stage 0
   Po_min = (Vo1+Vd_fw)*Io1_min+(Vo2+Vd_fw)*Io2_min;
   Po_max = (Vo1+Vd_fw)*Io1_max+(Vo2+Vd_fw)*Io2_max;
   
    //&#24320;&#20851;&#39057;v
   T = (1/fsw)*1000;  //fsw xxKhz
   Tch= (2/fsw)*1000;

   Vds_on = (Po_max*Rds_on)/(n*Vi_min);
   setVar("Po_max",round3(Po_max));
   setVar("Po_min",round3(Po_min));
   setVar("T",round3(T));
   setVar("Tch",round3(Tch));
   setVar("Vds_on",round3(Vds_on));
  
   
   //--------stage 1
   //&#35774;w亥e扭瘾H
   D_max = getVar("D_max");
   Ton_max = Tch*D_max;
   Nsp1 = (Vo1/(2*D_max)+Vd_fw)/(Vi_min-Vds_on);
   Dmin = Vo1/(2*Nsp1*(Vi_max-Vds_on)-Vd_fw);
   Dnom = Vo1/(2*Nsp1*(Vi_nom-Vds_on)-Vd_fw);
   
   setVar("Dnom",round2(Dnom)); 
   setVar("Dmin",round2(Dmin));
   setVar("Ton_max",round3(Ton_max));
   setVar("Nsp1",round2(Nsp1));

   //--stage2 ---
   Vsw_max = 2*(1.15*Vi_max);
   setVar("Vsw_max",Vsw_max);

   //--stage3 -- , primary and secondary current
   Ip_dc = Po_max/((Vi_min-Vds_on)*n);
   Ip_ft = Po_max/((Vi_min-Vds_on)*n*2*D_max);
   Ip_rms = Ip_ft* (Math.sqrt(D_max));
   Ip_ac  = Ip_ft* (Math.sqrt(D_max*(1-D_max)) );
  
   Is1_rms = Io1_max*(Math.sqrt(D_max) );
   Is2_rms = Io2_max*(Math.sqrt(D_max) ); 
   Is1_ac  = Io1_max*(Math.sqrt(D_max*(1-D_max)) );
   Is2_ac  = Io2_max*(Math.sqrt(D_max*(1-D_max)) ); 
  
   setVar("Ip_dc",round2(Ip_dc)); 
   setVar("Ip_ft",round2(Ip_ft));
   setVar("Ip_rms",round2(Ip_rms));
   setVar("Ip_ac",round2(Ip_ac));
   setVar("Is1_rms",round2(Is1_rms));
   setVar("Is2_rms",round2(Is2_rms));
   setVar("Is1_ac",round2(Is1_ac));
   setVar("Is2_ac",round2(Is2_ac));
}



function rv2Str(v)
{
	if( v<1000){
		return Math.round(v);
	}else if(v>=1000 && v<1000000){
		return Math.round((v/1000)*100)/100 + "K";
	}else if(v>=1000000){
		return Math.round((v/1000000)*100)/100 + "M";
	}
}

//Find a 1%, %5 serials resistor value
function realR(R)
{

//E96 1% Resistors
if(led.RRES.value == "0")
RstListStr = "0,1.0,1.1,1.2,1.3,1.5,1.6,1.8,2.0,2.2,2.4,2.7,3.0,3.3,3.6,3.9,4.3,4.7,5.1,5.6,6.2,6.8,7.5,8.2,9.1,10.0";
else if (led.RRES.value == "1")
RstListStr = "0,1.00,1.02,1.05,1.07,1.10,1.13,1.15,1.18,1.21,1.24,1.27,1.30,1.33,1.37,1.40,1.43,1.47,1.50,1.54,1.58,1.62,1.65,1.69,1.74,1.78,1.82,1.87,1.91,1.96,2.00,2.05,2.10,2.15,2.21,2.26,2.32,2.37,2.43,2.49,2.55,2.61,2.67,2.74,2.80,2.87,2.94,3.01,3.09,3.16,3.24,3.32,3.40,3.48,3.57,3.65,3.74,3.83,3.92,4.02,4.12,4.22,4.32,4.42,4.53,4.64,4.75,4.87,4.99,5.11,5.23,5.36,5.49,5.62,5.76,5.90,6.04,6.19,6.34,6.49,6.65,6.81,6.98,7.15,7.32,7.50,7.68,7.87,8.06,8.25,8.45,8.66,8.87,9.09,9.31,9.53,9.76,10.00";

RstList = RstListStr.split(",");

for(j=0;j<=6;j++){
Ts = Math.pow(10,j);
for(i=1; i<(RstList.length-1);i++){
RstDownRange = (parseFloat(RstList[i-1])+parseFloat(RstList[i]))*Ts / 2;
RstUpRange = (parseFloat(RstList[i+1])+parseFloat(RstList[i]))*Ts / 2;

if( (R > RstDownRange) && (R <= RstUpRange) ){
return parseFloat(RstList[i])*Ts;
}
}

}

//should never here..
return R;

}



// give a Watt value, return sutable resistor W
function rw2Str(a)
{
if( a*2<(1/8) ) return "1/8";
if( (a*2>=(1/8)) && (a*2<(1/4)) )return "1/4";
if ( (a*2>=(1/4)) && (a*2<(1/2)) ) return "1/2";
if ( (a*2>=(1/2)) && (a*2<1) )return "1";
if ( (a*2>=1) && (a*2<2) ) return "2";
if ( (a*2>=2) && (a*2<3) ) return "3";
if ( (a*2>=3) && (a*2<5) )return "5";
if ( (a*2>=5) ) return ">10";
}
        </script><font color="#808080" face="Arial" size="2">by hyl 2010.11.3<br>
        </font></p>
        <p style="margin-top: 0pt; margin-bottom: 0pt;" align="center"><font color="#808080" face="Arial" size="2">by hyl 2010.11.3<br>
        </font></p>
</form>
      </td>
    </tr>
  </tbody>
</table>

</body></html>